# EC2の概要

数分で利用可能となり、従量課金で利用可能な仮想サーバー

- 起動・ノード追加・削除・マシンスペック変更が数分で可能
- 汎用的なIntelアーキテクチャを採用
- 管理者権限で利用可能
- WindowsやLinuxなどのほとんどのOSをサポート
- OSまでは提供されているタイプを選択することで自動設定され、OSより上のレイヤーを自由に利用可能
- 独自のAmazon Machine Image(AMI)にOS設定を作成し、保存して再利用が可能

> インスタンス
>> EC2を利用する単位  
>> 任意のAZにインスタンスを立ち上げてサーバーとして利用する

## EC2のセッティングの流れ

1. 利用するAMIイメージ(OSセッティング)を選択
2. インスタンスタイプを選択
3. ストレージを選択
4. セキュリティグループを選択
5. SSHキーペアを設定

> AMIイメージ
>> EC2に設定するOS

> インスタンスタイプ
>> CPU・メモリ、ストレージ、ネットワークキャパシティなどのサーバーリソース  
>>
>> 表示例：t2.nano  
>> t:ファミリー  
>> 2:世代  
>> nano:インスタンスの容量

> ネットワークキャパシティ
>> 

> インスタンスファミリー
>> 何用のインスタンスなのか示す。

- M5:汎用
- T2:汎用
- C5:コンピューティング最適化
- H1:ストレージ最適化
- D2:ストレージ最適化
- R4:メモリ最適化
- X1:メモリ最適化
- F1:FPGA
- G3:GPU
[詳細は以下を参照](https://aws.amazon.com/jp/ec2/instance-types/)

### リザーブドインスタンス

長期利用契約にすることで最大75%割り引かれる制度

||スタンダード|コンバーティブル|
|-|-|-|
|AZ/インスタンスサイズ/ネットワークタイプ変更可否|有|有|
|インスタンスファミリー/OS/テナンシー/支払オプションの変更可否|無|有|
|リザーブドインスタンス マーケットプレイスでの販売可否|可|今後可能になる予定|

### スポットインスタンス

予備のコンピューティング容量をさらに安い値段で利用できる制度（最大90%引）

AWS側で削除されることになる可能性があるため、一時的な拡張の場合のみ利用するようにする

### 物理対応可能なインスタンス

物理サーバーにインスタンスを起動して制御が可能なタイプのインスタンス
|ハードウェア専有インスタンス|Dedicated Host|Bare Metal|
|-|-|-|
|✓ 専用HWのVPCで実行されるEC2インスタンス<br>✓ ホストHWのレベルで、他のAWSアカウントに属するインスタンスから物理的に分離する<br>✓ 同じAWSアカウントのイ ンスタンスとはHWを共有 する可能性がある|✓ EC2インスタンス容量を 完全にお客様専用として 利用できる物理サーバー<br>✓ サーバーにバインドされ た既存のソフトウェアラ イセンスを利用可能|✓ アプリケーションは基盤 となるサーバーのプロ セッサーとメモリーに直 接アクセス可能なインス タンス<br>✓ AWSの各種サービスとの 連携が可能でOSが直接下 層のハードウェアにアク セス可能|

### ストレージ

EC2で直接利用するストレージは不可分なインスタンスストアと自分で設定するEBSの2つ

|インスタンスストア|Elastic Block Store(EBS)|
|-|-|
|✓ ホストコンピュータに内蔵されたディスクでEC2と不可分のブロックレベルの物理ストレージ<br>✓ EC2の一時的なデータが保持され、EC2の停止・終了と共にクリアされる<br>✓ 無料|✓ ネットワークで接続されたブロックレベルのストレージでEC2とは独立して管理される<br>✓ EC2をTerminateしてもEBSは保持可能で、SnapshotをS3に保持可能<br>✓ 別途EBS料金が必要|

### セキュリティグループ

インスタンスへのトラフィックのアクセス可否を設定するファイアーウォール機能を提供

### キーペア

公開鍵と秘密鍵

### EC2のバックアップ

- 定期的にバックアップをとる
- 定期的にリカバリプロセスを確認する
- 複数のAZに重要なアプリケーションをデプロイすること
- フェイルオーバー対応を準備すること
- イベントをモニタリングして対応できるようにすること
- インスタンス起動時に動的IPアドレス処理の設定を行うこと

> リカバリプロセス
>>

> フェイルオーバー
>> 

> 動的IPアドレス
>>

# Elastic IP

動的に変わらないIPアドレス