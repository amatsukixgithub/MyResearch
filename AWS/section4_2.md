# IAM設計

自社の組織構造に合わせてAWSを利用するユーザーの役割やアクセス権限を設計することが重要

## IAM設計のベストプラクティス

1. アカウント設定などの必要な場合を除いて、ルートユーザーを利用しない
2. ルートユーザーなどの特権ユーザーに対して、MFAを有効化する。
3. 利用者ごとにIAMユーザーを作成する
4. 組織利用の場合は、役割ごとにIAMグループを作成してグループで管理するのを基本とする
5. 最小限の権限設定と不要な認証情報は削除を心がける
6. ユーザーのために強度の高いパスワードポリシーを設定する。
7. EC2インスタンスで作動するアプリケーションなどプログラムから利用する場合はなるべくロールを使用する。
8. モバイルやアプリケーションも含め、一時利用にはSTSなどで最小限の利用許可を与える
9. AWSアカウントのアクティビティの利用状況を常に監視する

## IAMユーザー or IAMグループ

|IAMユーザー|IAMグループ|
|-|-|
|少数利用が確定している場合|組織利用、組織利用になる可能性がある場合|

## グループ設計

1. AWS利用者と役割の洗い出し

- AWS利用者の特定
- 利用者の役割と利用範囲の整理

2. 利用グループへと集約

- 同じ役割や利用範囲を１つのグループにまとめる
- グループ別の名称と利用範囲を確定する

# IAMグループへのポリシー適用

|IT管理者|運用管理者|アプリ開発者|
|-|-|-|
|IT管理者としてルートユーザーも保持し、権限設定などの責任を負っている|運用管理全般を担っているスタッフで、様々なモニタリングと障害対応などで直接アプリに触れることもある|主ただったAWSサービスを利用してサービス開発を行っている。|
||||
|フルアクセスの管理者権限の付与(MFAが必須)|運用ツール全般と開発環境へのアクセスも付与して、DevOpsに参加できるようにする|担当しているアプリの開発範囲でのみアクセス権限を付与する|
||||
|管理ポリシー Administrator| ELB / EC2 / RDB / S3 / Auto-Scaling / VPC・Config / Trail / CloudWatch | ELB / EC2 / RDB / S3 / Auto-Scaling / VPC|

# AWS Organizationの適用

IAMのアクセス管理を大きな組織でも比較的楽に実施できるようにしたもの  
マスターアカウントが組織単位（OU）のグループを管理する。  
組織に属するアカウントはメンバーアカウントと呼ばれる。

- 複数アカウントの一括管理
  - AWSアカウントをグループ化してポリシーを適用して一元的に管理する
- 新規アカウント作成の自動化
  - コンソール／SDK／CLI でAWSアカウントを新規作成して、作成内容をログ管理できる
- 一括請求
  - 複数AWSアカウントの請求を一元化

## 機能セットの選択

- Consolidated Billing Only
  - 支払い一括代行のみ
- All Feature
  - 支払い一括代行、複数アカウントを統制
